---
import ServicePageLayout from '../layouts/ServicePageLayout.astro';
import SectionDivider from '../components/SectionDivider.astro';
import HomePriceCalculatorIsland from '../components/react/HomePriceCalculatorIsland';
import homeData from '../../../public/api/pages/home-solutions.json';

const page = homeData;
const PHONE_LINK = 'tel:+972508585310';
const PHONE_DISPLAY = '050-858-5310';

const hero = (page.sections as any[]).find(s => s.type === 'hero');
const calculator = (page.sections as any[]).find(s => s.type === 'calculator');
const howFenceWorks = (page.sections as any[]).find(s => s.type === 'how-fence-works');
const componentsDetail = (page.sections as any[]).find(s => s.type === 'components-detail');
const faq = (page.sections as any[]).find(s => s.type === 'faq');
---
<ServicePageLayout
  title={page.seo.title}
  description={page.seo.description}
  keywords={page.seo.keywords}
  canonical={page.seo.canonical}
  breadcrumbs={[{ label: "פתרונות לבית" }]}
  structuredData={page.structuredData}
>
  <!-- ══════════════ Hero ══════════════ -->
  <section class="py-12 md:py-20 bg-gradient-to-b from-primary/5 to-background">
    <div class="container">
      <div class="max-w-4xl mx-auto text-center">
        <div class="inline-flex items-center gap-2 bg-primary/10 text-primary px-4 py-2 rounded-full mb-6">
          <span class="font-bold">{hero?.badge}</span>
        </div>
        <h1 class="text-3xl md:text-5xl font-black mb-6" style="text-wrap: balance;">{page.h1}</h1>
        <p class="text-lg md:text-xl text-muted-foreground mb-4" style="text-wrap: pretty;">
          {hero?.subtitle}
        </p>
        <p class="text-sm text-muted-foreground mb-8">{hero?.trustLine}</p>

        <!-- CTA Buttons -->
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
          <a href={PHONE_LINK} class="btn-cta-glow inline-flex items-center gap-2 px-8 py-4 rounded-xl text-lg font-bold">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
            <span>התקשר לייעוץ - {PHONE_DISPLAY}</span>
          </a>
          <a href="#calculator" class="inline-flex items-center gap-2 px-8 py-4 rounded-xl text-lg font-bold border-2 border-primary text-primary hover:bg-primary hover:text-primary-foreground transition-all duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
            <span>חשב מחיר לחצר שלך</span>
          </a>
        </div>
      </div>
    </div>
  </section>

  <SectionDivider />

  <!-- ══════════════ Calculator (React Island) ══════════════ -->
  {calculator && (
    <section id="calculator" class="py-16 md:py-24 bg-background">
      <div class="container">
        <div class="max-w-2xl mx-auto">
          <div class="text-center mb-10">
            <div class="inline-flex items-center gap-2 bg-primary/10 text-primary px-4 py-2 rounded-full mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
              <span class="font-bold">מחשבון מחיר ביתי</span>
            </div>
            <h2 class="text-3xl md:text-4xl font-black text-foreground mb-3" style="text-wrap: balance;">
              {calculator.h2}
            </h2>
            <p class="text-muted-foreground" style="text-wrap: pretty;">{calculator.subtitle}</p>
          </div>
          <HomePriceCalculatorIsland client:visible />
        </div>
      </div>
    </section>
  )}

  <SectionDivider />

  <!-- ══════════════ How the Home Fence Works ══════════════ -->
  {howFenceWorks && (
    <section id="how-fence-works" class="py-12 md:py-16">
      <div class="container">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-2xl md:text-3xl font-bold mb-4 text-center">{howFenceWorks.h2}</h2>
          <p class="text-center text-muted-foreground mb-6" style="text-wrap: pretty;">{howFenceWorks.subtitle}</p>

          <!-- Intro paragraph - fully readable in HTML -->
          <div class="callout-box mb-10">
            <p class="text-foreground leading-relaxed text-lg" style="text-wrap: pretty;">
              {howFenceWorks.intro}
            </p>
          </div>

          <!-- Key Points Grid -->
          <div class="grid md:grid-cols-2 gap-6">
            {howFenceWorks.keyPoints?.map((point: any, i: number) => (
              <div class="card-forest rounded-2xl p-6 hover:border-primary/50 transition-all duration-300 hover:-translate-y-1">
                <div class="flex items-start gap-4">
                  <div class="flex-shrink-0 w-12 h-12 bg-primary/15 text-primary rounded-full flex items-center justify-center">
                    {i === 0 && <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 20h20"/><path d="M5 20V8l7-5 7 5v12"/><path d="M9 20v-6h6v6"/></svg>}
                    {i === 1 && <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v8"/><path d="m4.93 10.93 1.41 1.41"/><path d="M2 18h2"/><path d="M20 18h2"/><path d="m19.07 10.93-1.41 1.41"/><path d="M22 22H2"/><path d="m8 6 4-4 4 4"/><path d="M16 18a4 4 0 0 0-8 0"/></svg>}
                    {i === 2 && <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>}
                    {i === 3 && <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>}
                  </div>
                  <div>
                    <h3 class="text-lg font-bold mb-2 text-foreground">{point.title}</h3>
                    <p class="text-muted-foreground leading-relaxed" style="text-wrap: pretty;">{point.description}</p>
                  </div>
                </div>
              </div>
            ))}
          </div>

          <!-- Quick highlights bar -->
          <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-8 text-center">
            <div class="flex items-center gap-2 text-primary font-bold">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
              <span>התקנה ביום אחד</span>
            </div>
            <div class="flex items-center gap-2 text-primary font-bold">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>
              <span>שירות בכל הארץ</span>
            </div>
            <div class="flex items-center gap-2 text-primary font-bold">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
              <span>בטוח למשפחה</span>
            </div>
          </div>
        </div>
      </div>
    </section>
  )}

  <SectionDivider />

  <!-- ══════════════ System Components Detail ══════════════ -->
  {componentsDetail && (
    <section id="components" class="py-12 md:py-16 bg-muted/30">
      <div class="container">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-2xl md:text-3xl font-bold mb-4 text-center">{componentsDetail.h2}</h2>
          <p class="text-center text-muted-foreground mb-8" style="text-wrap: pretty;">{componentsDetail.subtitle}</p>
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            {componentsDetail.items?.map((item: any, i: number) => (
              <div class="bg-card border border-border rounded-2xl p-6 hover:border-primary/30 transition-all duration-300 hover:-translate-y-1">
                <div class="w-10 h-10 bg-primary/15 text-primary rounded-lg flex items-center justify-center mb-4">
                  {i === 0 && <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2 3 14h9l-1 8 10-12h-9l1-8z"/></svg>}
                  {i === 1 && <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="12" x="3" y="8" rx="2"/><path d="M10 8V6a2 2 0 1 1 4 0v2"/></svg>}
                  {i === 2 && <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>}
                  {i === 3 && <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>}
                  {i === 4 && <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 20h20"/><path d="M5 20V8l7-5 7 5v12"/></svg>}
                  {i === 5 && <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M3 12h18"/></svg>}
                </div>
                <h3 class="text-lg font-bold mb-2 text-foreground">{item.title}</h3>
                <p class="text-muted-foreground leading-relaxed text-sm" style="text-wrap: pretty;">{item.description}</p>
              </div>
            ))}
          </div>
        </div>
      </div>
    </section>
  )}

  <SectionDivider />

  <!-- ══════════════ FAQ ══════════════ -->
  {faq && (
    <section id="faq" class="py-12 md:py-16">
      <div class="container">
        <div class="max-w-3xl mx-auto">
          <h2 class="text-2xl md:text-3xl font-bold mb-4 text-center">{faq.h2}</h2>
          <p class="text-center text-muted-foreground mb-8">{faq.subtitle}</p>
          <div class="space-y-4">
            {faq.items?.map((item: any) => (
              <details class="card-forest rounded-xl px-6 group">
                <summary class="text-right text-lg font-bold cursor-pointer list-none flex items-center justify-between text-foreground hover:text-primary py-6">
                  <span style="text-wrap: balance;">{item.question}</span>
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform group-open:rotate-180 flex-shrink-0 mr-2"><path d="m6 9 6 6 6-6"/></svg>
                </summary>
                <p class="text-muted-foreground leading-relaxed pb-6" style="text-wrap: pretty;">{item.answer}</p>
              </details>
            ))}
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- ══════════════ CTA ══════════════ -->
  <section class="py-16 md:py-20 bg-primary text-primary-foreground">
    <div class="container">
      <div class="max-w-3xl mx-auto text-center">
        <h2 class="text-2xl md:text-4xl font-black mb-6">מוכנים להגן על הגינה?</h2>
        <p class="text-lg opacity-90 mb-8">התקשרו עכשיו לייעוץ חינם ולהצעת מחיר מותאמת – שירות בכל הארץ, התקנה ביום אחד</p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
          <a href={PHONE_LINK} class="inline-flex items-center gap-2 bg-white text-primary px-8 py-4 rounded-xl text-lg font-bold hover:bg-white/90 transition-colors">
            <span>התקשר - {PHONE_DISPLAY}</span>
          </a>
          <a href="#calculator" class="inline-flex items-center gap-2 border-2 border-white text-white px-8 py-4 rounded-xl text-lg font-bold hover:bg-white/10 transition-colors">
            <span>חשב מחיר עכשיו</span>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- ══════════════ Internal Links ══════════════ -->
  <section class="py-12">
    <div class="container">
      <div class="max-w-4xl mx-auto p-6 bg-card/50 border border-border rounded-xl">
        <h3 class="text-lg font-bold mb-4">קישורים נוספים:</h3>
        <div class="flex flex-wrap gap-4">
          {page.internalLinks.map((link: any) => (
            <a href={link.href} class="text-primary hover:underline">{link.label}</a>
          ))}
        </div>
      </div>
    </div>
  </section>
</ServicePageLayout>
